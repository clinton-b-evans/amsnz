{% extends "base.html" %}
{% load static %}
{% load mathfilters %}

{% block title %}
Year To Date {{ year }}
{% endblock title %}

{% block content %}
<script language="javascript" type="text/javascript">

  function popitup(url) {
    newwindow = window.open(url, '{{title}}', 'height=510,width=384');
    if (window.focus) { newwindow.focus() }
    return false;
  }

</script>

<!-- <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script> -->

<!-- <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script> -->

<!-- Google Chart -->
<script src="{% static 'GoogleChart/Gchart.js' %}"></script>

<!-- <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script> -->

<!-- <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script> -->


<!-- <div class="mb-3">
  <a href="popupex.html" onclick="return popitup('/incomestatements/add')"><button type="button"
      class="btn btn-secondary btn-sm">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar-plus"
        viewBox="0 0 16 16">
        <path
          d="M8 7a.5.5 0 0 1 .5.5V9H10a.5.5 0 0 1 0 1H8.5v1.5a.5.5 0 0 1-1 0V10H6a.5.5 0 0 1 0-1h1.5V7.5A.5.5 0 0 1 8 7z" />
        <path
          d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z" />
      </svg>

      New Entry
    </button></a>
  <a href="popupex.html" onclick="return popitup('/incomestatements/add_category')"><button type="button"
      class="btn btn-secondary btn-sm">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar-plus"
        viewBox="0 0 16 16">
        <path
          d="M8 7a.5.5 0 0 1 .5.5V9H10a.5.5 0 0 1 0 1H8.5v1.5a.5.5 0 0 1-1 0V10H6a.5.5 0 0 1 0-1h1.5V7.5A.5.5 0 0 1 8 7z" />
        <path
          d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z" />
      </svg>

      New Category
    </button></a>
</div> -->

<div class="row">
  <div class="col-lg-3">
    <select class="form-control mb-3" onchange="location = this.value;">
      <option selected="" value="" disabled>Select year</option>
      <option value="../2019">2019</option>
      <option value="../2020">2020</option>
      <option value="../2021">2021</option>
      <option value="../2022">2022</option>
      <option value="../2023">2023</option>
      <option value="../2024">2024</option>
      <option value="../2025">2025</option>
    </select>
  </div>

  <!-- <form action="/propertyincomestatements/yeartodate/{{year}}/" method="get">
  <select name="properties" id="properties" multiple>
    {% for obj in prop_qs %}
    <option value="{{ obj.pk }} ">{{ obj.name }}</option>
    {% endfor %}
  </select>
  <button type="submit" value="Submit">Filter</button>
  </form> -->

  <div class="col-lg-4">
    <form class="form-group" action="/propertyincomestatements/yeartodate/{{year}}/" method="get">
      <div class="row">
        <div class="col-9 select2-purple mb-2">
          <select name="properties" id="properties" class="select2" multiple="multiple" data-placeholder="Select properties"
            data-dropdown-css-class="select2-purple" style="width: 100%;">
            <!-- <option>Alabama</option>
            <option>Alaska</option>
            <option>California</option>
            <option>Delaware</option>
            <option>Tennessee</option>
            <option>Texas</option>
            <option>Washington</option> -->
            {% for obj in prop_qs %}
            <option value="{{ obj.pk }} ">{{ obj.name }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-3">
          <button class="btn btn-info" type="submit" value="Submit">Filter</button>
        </div>
      </div>
    </form>
  </div>

</div>

<div class="chart-container mt-5" style="position: relative;">
  <div class="row justify-content-around"> 
    <div class="col-9 bg-light p-4 shadow">

      <!-- <table class="table table-striped table-hover" style="font-size:small">
        <thead>
          <tr>
            <th>Category</th>
            <th>Amount</th>
          </tr>
        </thead>
        <tbody>


          {% for key, value in categories.items %}

          <tr>
            <td>{{key}}</td>
            <td>{{value}}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table> -->

      <table class="table table-hover" style="font-size:small">
        <thead>
          <tr>
            <th>YEAR - {{year}}</th>
            <th scope="col">Jan</th>
            <th scope="col">Feb</th>
            <th scope="col">Mar</th>
            <th scope="col">Apr</th>
            <th scope="col">May</th>
            <th scope="col">Jun</th>
            <th scope="col">Jul</th>
            <th scope="col">Aug</th>
            <th scope="col">Sep</th>
            <th scope="col">Oct</th>
            <th scope="col">Nov</th>
            <th scope="col">Dec</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th scope="col">INCOME</th>
          </tr>
          <tr>
            <td scope="row">Job</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
          </tr>
          <tr>
            <td scope="row">Rent Received</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
          </tr>
          <tr>
            <td scope="row">Interest</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
          </tr>
          <tr>
            <td scope="row">Wages</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
          </tr>
          <thead>
            <tr>
              <th scope="row">Total</th>
              <td>$0</td>
              <td>$0</td>
              <td>$0</td>
              <td>$0</td>
              <td>$0</td>
              <td>$0</td>
              <td>$0</td>
              <td>$0</td>
              <td>$0</td>
              <td>$0</td>
              <td>$0</td>
              <td>$0</td>
            </tr>
          </thead>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <th scope="col">EXPENSES</th>
          </tr>
          <tr>
            <td scope="row">Clothes</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
          </tr>
          <tr>
            <td scope="row">Entertainment</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
          </tr>
          <tr>
            <td scope="row">Food</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
          </tr>
          <tr>
            <td scope="row">Transport</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
          </tr>
          <tr>
            <td scope="row">Dance Lessons</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
          </tr>
          <tr>
            <td scope="row">Petrol</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
          </tr>
          <tr>
            <td scope="row">Car Maintenance</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
          </tr>
          <tr>
            <td scope="row">Mobile Allowance</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
          </tr>
          <tr>
            <td scope="row">Studies</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
            <td>$0</td>
          </tr>
          <thead>
            <tr style="background-color: #ededed">
              <th scope="row">Total</th>
              <td>$0</td>
              <td>$0</td>
              <td>$0</td>
              <td>$0</td>
              <td>$0</td>
              <td>$0</td>
              <td>$0</td>
              <td>$0</td>
              <td>$0</td>
              <td>$0</td>
              <td>$0</td>
              <td>$0</td>
            </tr>
          </thead>
        </tbody>
      </table>
    </div>

    <div class="col-3">
      <!-- <div align="center" class="mb-3">
        <h5>Expenses</h5>
        <canvas id="myChart" width="300px" height="300px"></canvas>
      </div> -->

      <!-- <div class="col p-2 bd-highlight">   -->
        <div id="donutchart" class="mb-3 shadow" style="width: 100%; height: 400px;"></div>  
      <!-- </div> -->

      <!-- <div align="center">
        <h5>Income Vs Expense</h5>
        <canvas id="pieChart" width="30px" height="30px"></canvas>
      </div> -->

      <div id="piechart" class="mb-3 shadow" style="width: 100%; height: 400px;"></div> 

    </div>
    <!-- <div class="col-lg-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title mb-5">Pie Chart</h5>

          <div id="pieChart" class="mb-5"></div>

          <script>
            document.addEventListener("DOMContentLoaded", () => {
              new ApexCharts(document.querySelector("#pieChart"), {
                series: [44, 55, 13, 43, 22],
                chart: {
                  height: 450,
                  type: 'pie',
                  toolbar: {
                    show: true
                  }
                },
                title: {
                  text: 'Networth Tracker {{year}}',
                  align: 'center',
                },
                labels: ['Team A', 'Team B', 'Team C', 'Team D', 'Team E']
              }).render();
            });
          </script>

        </div>
      </div>
    </div> -->
  </div>
</div>

<!-- jQuery -->
<!-- <script src="../../plugins/jquery/jquery.min.js"></script> -->

<!-- Select2 -->
<!-- <script src="../../plugins/select2/js/select2.full.min.js"></script> -->

<script>
  $(function () {
    //Initialize Select2 Elements
    $('.select2').select2()
  })
</script>

<!-- <script>
  document.addEventListener("DOMContentLoaded", () => {
    new Chart(document.querySelector('#pieChart'), {
      type: 'pie',
      data: {
        labels: [
          'Income',
          'Expence',
          // 'Yellow'
        ],
        datasets: [{
          label: 'My First Dataset',
          data: [300, 200],
          backgroundColor: [
            'rgb(255, 99, 132)',
            'rgb(54, 162, 235)',
            // 'rgb(255, 205, 86)'
          ],
          hoverOffset: 4
        }]
      },
      options: {
        plugins: {
          legend: {
            position: 'bottom',
            align: 'left',
          },
        },
      }
    });
  });
</script>

<script>
  const ctx = document.getElementById('myChart');
  const myChart = new Chart(ctx, {
    type: 'doughnut',
    data: {
      labels: [
        {% for key, value in categories_yearly.items %} 
        '{{key}}',
        {% endfor %}
      ],
      datasets: [{
        label: 'Categories',
        data: [
          {% for key, value in categories_yearly.items %} 
          '{{value|stringformat:"i"}}',
          {% endfor %}
        ],
        backgroundColor: [
          'rgba(255, 99, 132, 0.2)',
          'rgba(54, 162, 235, 0.2)',
          'rgba(255, 206, 86, 0.2)',
          'rgba(75, 192, 192, 0.2)',
          'rgba(153, 102, 255, 0.2)',
          'rgba(255, 159, 64, 0.2)'
        ],
        borderColor: [
          'rgba(255, 99, 132, 1)',
          'rgba(54, 162, 235, 1)',
          'rgba(255, 206, 86, 1)',
          'rgba(75, 192, 192, 1)',
          'rgba(153, 102, 255, 1)',
          'rgba(255, 159, 64, 1)'
        ],
        borderWidth: 1
      }]
    },
    options: {
      plugins: {
        legend: {
          position: 'bottom',
          align: 'left',
        },
      },
    }
  });
</script> -->

<script type="text/javascript">
  google.charts.load('current', {'packages':['corechart']});
  google.charts.setOnLoadCallback(drawChart);

  function drawChart() {

    var data = google.visualization.arrayToDataTable([
      ['Task', 'Hours per Day'],
      ['Work',     11],
      ['Eat',      2],
      ['Commute',  2],
      ['Watch TV', 2],
      ['Sleep',    7]
    ]);

    var options = {
      title: 'All Expenses',
      // is3D: true,
      pieHole: 0.4,
      // legend: 'none',
      // pieSliceText: 'label',
      legend: {position: 'bottom', alignment: 'start'}
    };

    var chart = new google.visualization.PieChart(document.getElementById('donutchart'));

    chart.draw(data, options);
  }
</script>

<script type="text/javascript">
  google.charts.load('current', {'packages':['corechart']});
  google.charts.setOnLoadCallback(drawChart);

  function drawChart() {

    var data = google.visualization.arrayToDataTable([
      ['Task', 'Hours per Day'],
      ['Income',     11],
      ['Expense',    7]
    ]);

    var options = {
      title: 'Income Vs Expense',
      // is3D: true,
      // pieHole: 0.4,
      // legend: 'none',
      // pieSliceText: 'label',
      legend: {position: 'bottom', alignment: 'center'}
    };

    var chart = new google.visualization.PieChart(document.getElementById('piechart'));

    chart.draw(data, options);
  }
</script>


<br>


{% endblock content %}